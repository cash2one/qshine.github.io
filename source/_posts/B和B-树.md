---
title: B和B+树
date: 2017-11-01 20:59:29
categories: 数据结构和算法
tags:
---

### 1. 多路查找树
**多路查找树(multi-way search tree)**, 其中一个节点的孩子数量可以多于两个, 且每一个节点处可以存储多个元素, 由于是查找树, 所以元素之间有某种关系.

**注**: `2-3树`, `2-3-4树`, `B树`, `B+树`都是多路查找树, 其中`2-3树`定义如下
```
每一个节点都具有两个孩子(2节点)或3个孩子(3节点)
- 2节点: 包含一个元素和两个孩子(或没有孩子), `左节点值 < 该节点值 < 右节点值`
- 3节点: 包含大小两个元素和三个孩子(或没有孩子), `左节点值 < 中间节点值 < 右节点值`
```


### 2. B(B-)树

当要操作的数据非常大的时候, 就不能把全部数据导入内存, 必须把数据放在外部存储设备上, 如硬盘, 一旦涉及外部存储设备, 就不仅仅是查找时花费的时间, 还要加上速度很慢的`磁盘IO`时间. 如要在磁盘中找出一个文件, 读取磁盘几千次和几十次差别很大.

针对数据库的树形结构要尽量降低高度, 才能减少和硬盘的交互.

> **B树**是一种平衡的多路查找树, 2-3树和2-3-4树都是B树的特例, 节点下最大的孩子数量称为**B树的阶**, 所以2-3树是3阶B树, 2-3-4树是4阶B. 注: m阶B树就是说某个节点最多有m个孩子

![4jie](http://oh7hdmoe1.bkt.clouddn.com/17-10-6/11977428.jpg)
以上为4阶B树

#### m阶B树具有以下特征
- 根节点至少有两个子树
- 每个非根节点有`k-1个`元素和`k个`孩子, 其中`m/2 <= k <= m`, 每一个叶子节点都包含`k-1个`元素, `m/2 <= k <= m`
- 所有叶子节点都位于同一层
- 每个节点的元素从小到大排列, 如上图中`k1 < kn`, Ai为指向子树根节点的指针


#### B树怎样提高效率
硬盘将所有信息分割为相等大小的页面, 每次读写都是一整个页面, 在B树应用中, 不能一次将所有数据加载到内存, 因此调整B树让B树的阶为与硬盘存储的页面大小相同, 比如一个1001阶B树,(1个节点含有1000个元素), 高度为2, 则可以存储超过`10亿(1000*1000*1000)`个元素, 之后仅需让根节点存储在内存中, 寻找一个元素最多进行2次硬盘读写即可, 数据的比较实在内存中进行的, 相对于硬盘IO可以忽略. 这样每一次磁盘访问都能获得最大量的数据

B树相对于二叉搜索树
1. 降低了树的高度, 减少了磁盘IO
2. 比较次数没有变化, 但是B树使用的内存进行比较, 速度较快

#### 应用
- MongoDB
- 文件系统


### 2. B+树
m阶B+树有以下特征
- 有k个子树的中间节点有k个元素(B树是k-1个)
- 所有叶子节点包含全部元素信息, 及指向包含这些元素的指针. 叶子节点的所有元素按照从小到大排列
- 所有中间节点是索引, 并且中间节点包含的元素同时存在于`子节点`, 在子节点中是`最大(或最小)元素`

![B+树](http://oh7hdmoe1.bkt.clouddn.com/17-10-9/86449324.jpg)

#### B+树的优势
1. 若是要随机查找, 从根节点出发, 方式和B树类似, 但是最终要到叶子节点, 所以性能更稳定
2. 按照从小到大进行范围查找, , 可以直接对叶子节点进行查找, 不经过中间节点, 沿着指向下一叶子的指针就可得到结果

#### 应用
- MySQL数据库



### 资料
- 梦见公众号
- 大话数据结构P341




