---
title: CSRF攻击
date: 2017-8-17 12:02:15
categories: 安全
tags:
  - 安全
---

CSRF: 跨站请求伪造, 也叫XSRF

攻击者可以利用该漏洞盗用用户身份去做违法的事情

实例:

网站A为购物网站(未做CSRF防护), 网站B为危险网站

1. 用户登陆了A网站准备购物, 登陆后A站cookie就已经写入浏览器中

2. 中途用户点击了B网站(并未退出A), B站中有链接指向了A站, 假如指向的是结算链接`\<img src=‘结算链接'\>`

3. B站刷新的时候会主动访问A, 此时浏览器会带着A的cookie去访问A, 此时A站并不知, 仍会做出响应

### 关于防御

#### 检查Referer字段
校验请求来自哪里, 通常情况下Referer要求和请求的地址时同一域名下, 但是并不能保证, 因为可以伪造

#### 添加校验token
在表单里增加token值, 值是一个伪随机数, 由服务端生成, 表单提交的时候会带上token, 服务端去做校验, 因为随机数是请求的时候生成的, 所以攻击者并不能预先得到


### 资料
- [跨站请求伪造-维基百科](https://zh.wikipedia.org/wiki/%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0)
- [CSRF攻击方式](https://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html)
